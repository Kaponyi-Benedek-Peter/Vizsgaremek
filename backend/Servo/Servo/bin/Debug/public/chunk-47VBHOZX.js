import{b as j}from"./chunk-SF2QL2AW.js";import{e as z,g as E,h as I,k as V,n as B,p as R}from"./chunk-MXNZA3P6.js";import{$ as f,$a as m,Ba as n,Ja as _,Kb as o,Lb as a,Oa as k,S as y,Z as b,_ as C,aa as u,ab as v,ac as w,ec as S,gb as e,hb as t,ib as x,ja as g,mb as P,ob as O,qb as M,xb as i,yb as l,zb as h}from"./chunk-766VLGYE.js";function D(s,d){if(s&1){let r=P();e(0,"div",2)(1,"div",3),f(),e(2,"svg",4),x(3,"path",5),t()(),u(),e(4,"h1"),i(5),o(6,"translate"),t(),e(7,"p",6),i(8),o(9,"translate"),t(),e(10,"div",7)(11,"div",8)(12,"span",9),i(13,"1"),t(),e(14,"p"),i(15),o(16,"translate"),t()(),e(17,"div",8)(18,"span",9),i(19,"2"),t(),e(20,"p"),i(21),o(22,"translate"),t()(),e(23,"div",8)(24,"span",9),i(25,"3"),t(),e(26,"p"),i(27),o(28,"translate"),t()()(),e(29,"div",10)(30,"p"),i(31),o(32,"translate"),t(),e(33,"button",11),O("click",function(){b(r);let p=M();return C(p.resendEmail())}),i(34),o(35,"translate"),t()(),e(36,"a",12),i(37),o(38,"translate"),t()()}s&2&&(n(5),l(a(6,8,"auth.email.check_inbox")),n(3),l(a(9,10,"auth.email.sent_message")),n(7),l(a(16,12,"auth.email.step_1")),n(6),l(a(22,14,"auth.email.step_2")),n(6),l(a(28,16,"auth.email.step_3")),n(4),l(a(32,18,"auth.email.no_email")),n(3),h(" ",a(35,20,"auth.email.resend")," "),n(3),h(" ",a(38,22,"auth.email.back_to_login")," "))}function N(s,d){s&1&&(e(0,"div",2)(1,"div",3),x(2,"div",13),t(),e(3,"h1"),i(4),o(5,"translate"),t(),e(6,"p",6),i(7),o(8,"translate"),t()()),s&2&&(n(4),l(a(5,2,"auth.email.verifying")),n(3),l(a(8,4,"auth.email.verifying_message")))}function A(s,d){s&1&&(e(0,"div",2)(1,"div",14),f(),e(2,"svg",15),x(3,"path",16),t()(),u(),e(4,"h1"),i(5),o(6,"translate"),t(),e(7,"p",6),i(8),o(9,"translate"),t(),e(10,"div",17)(11,"p"),i(12),o(13,"translate"),t()()()),s&2&&(n(5),l(a(6,3,"auth.email.verified")),n(3),l(a(9,5,"auth.email.verified_message")),n(4),l(a(13,7,"auth.email.redirecting")))}function H(s,d){if(s&1){let r=P();e(0,"div",2)(1,"div",18),f(),e(2,"svg",19),x(3,"circle",20)(4,"path",21),t()(),u(),e(5,"h1"),i(6),o(7,"translate"),t(),e(8,"p",22),i(9),o(10,"translate"),t(),e(11,"div",23)(12,"button",24),O("click",function(){b(r);let p=M();return C(p.resendEmail())}),i(13),o(14,"translate"),t(),e(15,"a",25),i(16),o(17,"translate"),t()()()}if(s&2){let r=M();n(6),l(a(7,4,"auth.email.verification_failed")),n(3),l(a(10,6,r.errorMessage())),n(4),h(" ",a(14,8,"auth.email.try_again")," "),n(3),h(" ",a(17,10,"auth.email.back_to_register")," ")}}var T=class s{constructor(d,r,c){this.route=d;this.router=r;this.authService=c}location=y(w);isVerifying=g(!1);isVerified=g(!1);errorMessage=g("");userId=g("");token=g("");ngOnInit(){let d=new URLSearchParams(window.location.search).get("activate")||"",r=d.split(";");if(!d){this.errorMessage.set("auth.errors.invalid_verification_link");return}if(r.length!==2){this.errorMessage.set("auth.errors.invalid_verification_link");return}let c=r[0].trim(),p=r[1].trim();if(!c||!p){this.errorMessage.set("auth.errors.invalid_verification_link");return}let L=`/registration-promise?activate=${c};${p}`;this.location.replaceState(L),this.userId.set(c),this.token.set(p),this.verifyEmail()}verifyEmail(){this.isVerifying.set(!0),this.errorMessage.set("");let d=this.userId(),r=this.token();if(!d||!r){this.errorMessage.set("auth.errors.invalid_verification_link"),this.isVerifying.set(!1);return}this.authService.completeRegistration(d,r,!0).subscribe({next:()=>{this.isVerifying.set(!1),this.isVerified.set(!0),setTimeout(()=>{this.router.navigate(["/home"])},2500)},error:c=>{this.isVerifying.set(!1),this.errorMessage.set(c.message||"auth.errors.verification_failed")}})}resendEmail(){this.router.navigate(["/register"])}static \u0275fac=function(r){return new(r||s)(_(z),_(E),_(j))};static \u0275cmp=k({type:s,selectors:[["app-registration-promise"]],decls:6,vars:4,consts:[[1,"auth-container"],[1,"auth-card","verification-card"],[1,"verification-content"],[1,"icon-wrapper"],["viewBox","0 0 24 24","fill","none","stroke","currentColor",1,"mail-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"],[1,"verification-text"],[1,"verification-steps"],[1,"step"],[1,"step-number"],[1,"verification-help"],[1,"link-btn",3,"click"],["routerLink","/login",1,"back-link"],[1,"spinner-large"],[1,"icon-wrapper","success"],["viewBox","0 0 24 24","fill","none","stroke","currentColor",1,"check-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","3","d","M5 13l4 4L19 7"],[1,"redirect-info"],[1,"icon-wrapper","error"],["viewBox","0 0 24 24","fill","none","stroke","currentColor",1,"error-icon"],["cx","12","cy","12","r","10","stroke-width","2"],["stroke-linecap","round","stroke-width","2","d","M12 8v4M12 16h.01"],[1,"error-message"],[1,"error-actions"],[1,"submit-btn",3,"click"],["routerLink","/register",1,"link"]],template:function(r,c){r&1&&(e(0,"div",0)(1,"div",1),m(2,D,39,24,"div",2),m(3,N,9,6,"div",2),m(4,A,14,9,"div",2),m(5,H,18,12,"div",2),t()()),r&2&&(n(2),v(!c.token()&&!c.isVerifying()&&!c.isVerified()&&!c.errorMessage()?2:-1),n(),v(c.isVerifying()?3:-1),n(),v(c.isVerified()&&!c.errorMessage()?4:-1),n(),v(c.errorMessage()?5:-1))},dependencies:[S,V,I,R,B],styles:['.auth-container[_ngcontent-%COMP%]{min-height:calc(100vh - 255px);display:flex;align-items:center;justify-content:center;padding:var(--space-8) var(--space-4);background-color:var(--bg-secondary)}.auth-card[_ngcontent-%COMP%]{background-color:var(--bg-primary);border-radius:var(--radius-lg);box-shadow:var(--shadow-lg);padding:var(--space-10);width:100%;max-width:440px;transition:all var(--transition-normal)}.auth-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:var(--space-8)}.auth-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:var(--text-3xl);font-weight:var(--font-bold);color:var(--text-primary);margin-bottom:var(--space-2)}.auth-subtitle[_ngcontent-%COMP%]{font-size:var(--text-base);color:var(--text-secondary);margin:0}.auth-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--space-5)}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--space-2)}.form-label[_ngcontent-%COMP%]{font-size:var(--text-sm);font-weight:var(--font-medium);color:var(--text-primary)}.form-input[_ngcontent-%COMP%]{width:100%;padding:var(--space-3) var(--space-4);font-size:1rem;font-family:var(--font-primary);color:var(--input-text);background-color:var(--input-bg);border:2px solid var(--input-border);border-radius:var(--radius-md);transition:all var(--transition-fast);outline:none;min-height:48px;box-sizing:border-box}.form-input[_ngcontent-%COMP%]:focus{border-color:var(--color-border-focus);box-shadow:0 0 0 3px #067a451a}.form-input[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.form-input[_ngcontent-%COMP%]::placeholder{color:var(--input-placeholder)}.password-input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.password-input-wrapper[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{padding-right:var(--space-12)}.password-toggle[_ngcontent-%COMP%]{position:absolute;right:0;width:44px;height:44px;background:none;border:none;cursor:pointer;font-size:var(--text-xl);display:flex;align-items:center;justify-content:center;color:var(--text-secondary);transition:color var(--transition-fast);border-radius:0 var(--radius-md) var(--radius-md) 0}@media(hover:hover)and (pointer:fine){.password-toggle[_ngcontent-%COMP%]:hover{color:var(--text-primary)}}.password-toggle[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.5}.checkbox-group[_ngcontent-%COMP%]{flex-direction:row;align-items:center;gap:var(--space-2)}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-2);cursor:pointer;font-size:var(--text-sm);color:var(--text-primary);-webkit-user-select:none;user-select:none;min-height:44px}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:20px;height:20px;cursor:pointer;accent-color:var(--color-primary);flex-shrink:0}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.5}.error-message[_ngcontent-%COMP%]{padding:var(--space-3) var(--space-4);background-color:#dc26261a;color:var(--color-error);border-radius:var(--radius-md);font-size:var(--text-sm);border-left:4px solid var(--color-error)}.submit-btn[_ngcontent-%COMP%]{width:100%;padding:var(--space-3) var(--space-6);font-size:var(--text-base);font-weight:var(--font-semibold);font-family:var(--font-primary);color:var(--btn-primary-text);background-color:var(--btn-primary-bg);border:none;border-radius:var(--radius-md);cursor:pointer;transition:all var(--transition-normal);display:flex;align-items:center;justify-content:center;gap:var(--space-2);min-height:48px}@media(hover:hover)and (pointer:fine){.submit-btn[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--btn-primary-hover);transform:translateY(-1px);box-shadow:var(--shadow-md)}}.submit-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.submit-btn[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.spinner[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;flex-shrink:0}.auth-links[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:var(--space-2)}.link[_ngcontent-%COMP%]{font-size:var(--text-sm);color:var(--text-secondary);text-decoration:none;transition:color var(--transition-fast);padding:var(--space-2) 0;display:inline-block}@media(hover:hover)and (pointer:fine){.link[_ngcontent-%COMP%]:hover{color:var(--color-primary);text-decoration:underline}}.auth-divider[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:center;margin:var(--space-6) 0 var(--space-4);color:var(--text-secondary);font-size:var(--text-sm)}.auth-divider[_ngcontent-%COMP%]:before, .auth-divider[_ngcontent-%COMP%]:after{content:"";flex:1;border-bottom:1px solid var(--border-color)}.auth-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:0 var(--space-3)}.auth-footer[_ngcontent-%COMP%]{text-align:center;margin-top:var(--space-2)}.auth-footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:var(--text-sm);color:var(--text-secondary);margin:0}.link-primary[_ngcontent-%COMP%]{color:var(--color-primary);text-decoration:none;font-weight:var(--font-semibold);transition:color var(--transition-fast);padding:var(--space-1) 0;display:inline-block}@media(hover:hover)and (pointer:fine){.link-primary[_ngcontent-%COMP%]:hover{color:var(--color-primary-hover);text-decoration:underline}}.verification-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center;gap:var(--space-4);padding:var(--space-4) 0}.icon-wrapper[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;background-color:#067a451a;display:flex;align-items:center;justify-content:center;flex-shrink:0}.icon-wrapper.success[_ngcontent-%COMP%]{background-color:#067a4526}.mail-icon[_ngcontent-%COMP%], .check-icon[_ngcontent-%COMP%]{width:40px;height:40px;color:var(--color-primary);stroke:var(--color-primary)}.verification-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:var(--text-2xl);font-weight:var(--font-bold);color:var(--text-primary);margin:0}.verification-text[_ngcontent-%COMP%]{font-size:var(--text-base);color:var(--text-secondary);margin:0;max-width:340px;line-height:1.6}.verification-steps[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--space-3);width:100%;text-align:left}.step[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:var(--space-3)}.step-number[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:50%;background-color:var(--color-primary);color:#fff;font-size:var(--text-sm);font-weight:var(--font-bold);display:flex;align-items:center;justify-content:center;flex-shrink:0}.step[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:var(--text-sm);color:var(--text-secondary);margin:0;padding-top:var(--space-1);line-height:1.5}.redirect-info[_ngcontent-%COMP%]{padding:var(--space-3) var(--space-4);background-color:#067a4514;border-radius:var(--radius-md);width:100%}.redirect-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:var(--text-sm);color:var(--color-primary);margin:0;font-weight:var(--font-medium)}.form-hint[_ngcontent-%COMP%]{font-size:var(--text-xs);color:var(--text-secondary);margin-top:var(--space-1);margin-bottom:0}@media(max-width:768px){.auth-container[_ngcontent-%COMP%]{padding:var(--space-4) var(--space-3);align-items:flex-start;padding-top:var(--space-8)}.auth-card[_ngcontent-%COMP%]{padding:var(--space-8) var(--space-6)}.auth-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:var(--text-2xl)}.auth-header[_ngcontent-%COMP%]{margin-bottom:var(--space-6)}}@media(max-width:480px){.auth-container[_ngcontent-%COMP%]{padding:var(--space-3) var(--space-3);padding-top:var(--space-6);align-items:flex-start}.auth-card[_ngcontent-%COMP%]{padding:var(--space-6) var(--space-4);border-radius:var(--radius-md)}.auth-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:var(--text-xl)}.auth-subtitle[_ngcontent-%COMP%]{font-size:var(--text-sm)}.auth-form[_ngcontent-%COMP%]{gap:var(--space-4)}.auth-divider[_ngcontent-%COMP%]{margin:var(--space-4) 0 var(--space-3)}.verification-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:var(--text-xl)}.icon-wrapper[_ngcontent-%COMP%]{width:64px;height:64px}.mail-icon[_ngcontent-%COMP%], .check-icon[_ngcontent-%COMP%]{width:32px;height:32px}}@media(max-width:375px){.auth-container[_ngcontent-%COMP%]{padding:var(--space-2) var(--space-2);padding-top:var(--space-4)}.auth-card[_ngcontent-%COMP%]{padding:var(--space-5) var(--space-3)}.auth-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:var(--text-lg)}.auth-form[_ngcontent-%COMP%]{gap:var(--space-3)}.step-number[_ngcontent-%COMP%]{width:24px;height:24px;font-size:var(--text-xs)}}@media(prefers-reduced-motion:reduce){.spinner[_ngcontent-%COMP%]{animation:none;border-top-color:#fff;opacity:.7}.submit-btn[_ngcontent-%COMP%], .link[_ngcontent-%COMP%], .link-primary[_ngcontent-%COMP%], .password-toggle[_ngcontent-%COMP%]{transition:none}}.verification-card[_ngcontent-%COMP%]{max-width:500px}.spinner-large[_ngcontent-%COMP%]{width:56px;height:56px;border:4px solid rgba(6,122,69,.15);border-top-color:var(--color-primary);border-radius:50%;animation:_ngcontent-%COMP%_spin .9s linear infinite}.icon-wrapper.error[_ngcontent-%COMP%]{background-color:#dc26261a}.error-icon[_ngcontent-%COMP%]{width:40px;height:40px;color:var(--color-error);stroke:var(--color-error)}.link-btn[_ngcontent-%COMP%]{background:none;border:none;color:var(--color-primary);font-size:var(--text-sm);font-weight:var(--font-semibold);cursor:pointer;text-decoration:underline;padding:var(--space-2) 0;font-family:var(--font-primary);min-height:44px;display:inline-flex;align-items:center}.auth-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px 16px;background:var(--color-background)}.auth-card[_ngcontent-%COMP%]{background:var(--color-surface);border:1px solid var(--color-border);border-radius:16px;padding:48px 40px;width:100%;max-width:480px;box-shadow:var(--shadow-lg);text-align:center}.verification-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px}.icon-wrapper[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:var(--color-surface-elevated);margin-bottom:8px}.icon-wrapper.success[_ngcontent-%COMP%]{background:#067a451f}.icon-wrapper.error[_ngcontent-%COMP%]{background:#dc26261a}.check-icon[_ngcontent-%COMP%]{width:44px;height:44px;stroke:var(--color-primary)}.error-icon[_ngcontent-%COMP%]{width:44px;height:44px;stroke:var(--color-error)}.mail-icon[_ngcontent-%COMP%]{width:44px;height:44px;stroke:var(--color-primary)}.spinner-large[_ngcontent-%COMP%]{width:44px;height:44px;border:4px solid var(--color-border);border-top-color:var(--color-primary);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}h1[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:var(--color-text-primary);margin:0}.verification-text[_ngcontent-%COMP%]{color:var(--color-text-secondary);line-height:1.6;margin:0}.redirect-info[_ngcontent-%COMP%]{padding:12px 20px;background:#067a4514;border-radius:8px;color:var(--color-primary);font-size:.9rem;font-weight:500}.verification-steps[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;width:100%;text-align:left}.step[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px}.step-number[_ngcontent-%COMP%]{width:28px;height:28px;min-width:28px;border-radius:50%;background:var(--color-primary);color:#fff;font-size:.85rem;font-weight:700;display:flex;align-items:center;justify-content:center}.step[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--color-text-secondary);margin:0;padding-top:4px;font-size:.95rem}.verification-help[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px;color:var(--color-text-secondary);font-size:.9rem}.link-btn[_ngcontent-%COMP%]{background:none;border:none;color:var(--color-primary);font-size:.9rem;font-weight:600;cursor:pointer;padding:0;text-decoration:underline}.back-link[_ngcontent-%COMP%]{color:var(--color-text-secondary);font-size:.9rem;text-decoration:none}.back-link[_ngcontent-%COMP%]:hover{color:var(--color-primary)}.submit-btn[_ngcontent-%COMP%]{width:100%;padding:12px;background:var(--gradient-primary);color:#fff;border:none;border-radius:10px;font-size:1rem;font-weight:600;cursor:pointer}.error-message[_ngcontent-%COMP%]{color:var(--color-error);margin:0}.error-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px;width:100%}.link[_ngcontent-%COMP%]{color:var(--color-text-secondary);font-size:.9rem}@media(max-width:480px){.auth-card[_ngcontent-%COMP%]{padding:32px 20px}}@media(hover:hover)and (pointer:fine){.link-btn[_ngcontent-%COMP%]:hover{color:var(--color-primary-hover)}}.back-link[_ngcontent-%COMP%]{color:var(--color-primary);font-size:var(--text-sm);text-decoration:none;font-weight:var(--font-medium);min-height:44px;display:inline-flex;align-items:center}@media(hover:hover)and (pointer:fine){.back-link[_ngcontent-%COMP%]:hover{text-decoration:underline}}.error-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:var(--space-3);width:100%}.verification-help[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:var(--space-1);font-size:var(--text-sm);color:var(--text-secondary);text-align:center}@media(max-width:480px){.verification-card[_ngcontent-%COMP%]{max-width:100%}.spinner-large[_ngcontent-%COMP%]{width:48px;height:48px}}@media(prefers-reduced-motion:reduce){.spinner-large[_ngcontent-%COMP%]{animation:none;border-top-color:var(--color-primary);opacity:.6}}']})};export{T as RegistrationPromise};
