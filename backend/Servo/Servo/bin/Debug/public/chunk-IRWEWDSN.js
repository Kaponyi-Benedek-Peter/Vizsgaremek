import{b as l}from"./chunk-ZKCDJ2NS.js";import{b as p,q as d}from"./chunk-DXTRCEFC.js";import{J as o,N as c,S as i,l as a,y as s}from"./chunk-33H2QBHE.js";var h=class n{API_URL=d.baseURL;http=i(p);authService=i(l);getProfile(){return this.http.get(`${this.API_URL}/api/profile`).pipe(s(this.handleError))}updateProfile(r){let e={};return r.firstname&&(e.firstname=this.encodeBase64(r.firstname)),r.lastname&&(e.lastname=this.encodeBase64(r.lastname)),r.email&&(e.email=this.encodeBase64(r.email)),this.http.put(`${this.API_URL}/api/profile`,e).pipe(o(t=>{console.log("Profile updated successfully")}),s(this.handleError))}deleteAccountRequest(r,e){let t={id:this.encodeBase64(r),password:this.encodeBase64(e)};return this.http.post(`${this.API_URL}/api/delacc_request`,t).pipe(o(()=>{console.log("Account deletion requested - confirmation email sent")}),s(this.handleError))}confirmAccountDeletion(r,e){let t={id:this.encodeBase64(r),token:this.encodeBase64(e)};return this.http.post(`${this.API_URL}/api/delacc_promise`,t).pipe(o(()=>{console.log("Account deleted successfully"),this.authService.logout()}),s(this.handleError))}changePassword(r,e,t){let u={id:this.encodeBase64(r),currentPassword:this.encodeBase64(e),newPassword:this.encodeBase64(t)};return this.http.post(`${this.API_URL}/api/change-password`,u).pipe(o(()=>{console.log("Password changed successfully")}),s(this.handleError))}getOrderHistory(){return this.http.get(`${this.API_URL}/api/orders`).pipe(s(this.handleError))}getSavedAddresses(){return this.http.get(`${this.API_URL}/api/addresses`).pipe(s(this.handleError))}encodeBase64(r){try{return btoa(unescape(encodeURIComponent(r)))}catch(e){return console.error("Base64 encoding error:",e),btoa(r)}}decodeBase64(r){try{return decodeURIComponent(escape(atob(r)))}catch(e){return console.error("Base64 decoding error:",e),atob(r)}}handleError(r){let e="An unknown error occurred";if(r.error instanceof ErrorEvent)e=`Error: ${r.error.message}`;else switch(r.status){case 400:e="account.errors.bad_request";break;case 401:e="account.errors.unauthorized";break;case 403:e="account.errors.forbidden";break;case 404:e="account.errors.not_found";break;case 500:e="account.errors.server_error";break;default:e=r.error?.message||r.message||e}return console.error("Account Service Error:",e),a(()=>new Error(e))}static \u0275fac=function(e){return new(e||n)};static \u0275prov=c({token:n,factory:n.\u0275fac,providedIn:"root"})};export{h as a};
