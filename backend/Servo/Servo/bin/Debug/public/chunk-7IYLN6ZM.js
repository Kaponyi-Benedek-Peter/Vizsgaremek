import{b as B}from"./chunk-X6PFKWKM.js";import{g as y,k as I,n as R,p as T}from"./chunk-Y5C4H5IK.js";import{$ as f,$a as g,Ba as n,Ja as P,Kb as s,Lb as c,Oa as E,S as h,Z as w,_ as M,aa as _,ab as u,ac as k,ec as O,ja as m,jb as e,kb as r,lb as v,mb as b,pb as C,qb as x,xb as o,yb as p,zb as S}from"./chunk-766VLGYE.js";function D(a,d){a&1&&(e(0,"div",2),v(1,"div",3),e(2,"h1"),o(3),s(4,"translate"),r(),e(5,"p",4),o(6),s(7,"translate"),r()()),a&2&&(n(3),p(c(4,2,"auth.password_change.processing")),n(3),p(c(7,4,"auth.password_change.please_wait")))}function N(a,d){a&1&&(e(0,"div",2)(1,"div",5),f(),e(2,"svg",6),v(3,"path",7),r()(),_(),e(4,"h1"),o(5),s(6,"translate"),r(),e(7,"p",4),o(8),s(9,"translate"),r(),e(10,"div",8)(11,"p"),o(12),s(13,"translate"),r()()()),a&2&&(n(5),p(c(6,3,"auth.password_change.success")),n(3),p(c(9,5,"auth.password_change.success_message")),n(4),p(c(13,7,"auth.password_change.redirecting")))}function V(a,d){if(a&1){let t=b();e(0,"div",2)(1,"div",9),f(),e(2,"svg",10),v(3,"path",11),r()(),_(),e(4,"h1"),o(5),s(6,"translate"),r(),e(7,"p",12),o(8),s(9,"translate"),r(),e(10,"button",13),C("click",function(){w(t);let l=x();return M(l.backToLogin())}),o(11),s(12,"translate"),r()()}if(a&2){let t=x();n(5),p(c(6,3,"auth.password_change.error_title")),n(3),p(c(9,5,t.errorMessage())),n(3),S(" ",c(12,7,"auth.password_change.back_to_login")," ")}}var L=class a{constructor(d){this.router=d}location=h(k);authService=h(B);isProcessing=m(!1);isSuccess=m(!1);errorMessage=m("");ngOnInit(){let t=(new URLSearchParams(window.location.search).get("chpass")||"").split(";");if(t.length!==2){this.errorMessage.set("auth.errors.invalid_reset_link");return}let i=t[0].trim(),l=t[1].trim();if(!i||!l){this.errorMessage.set("auth.errors.invalid_reset_link");return}let j=`/password-reset?chpass=${i};${l}`;this.location.replaceState(j),this.completePasswordReset(i,l)}completePasswordReset(d,t){this.isProcessing.set(!0),this.errorMessage.set(""),this.authService.completePasswordChange(d,t).subscribe({next:()=>{this.isProcessing.set(!1),this.isSuccess.set(!0),this.authService.logout(),setTimeout(()=>{this.router.navigate(["/login"])},2500)},error:i=>{this.isProcessing.set(!1),this.errorMessage.set(i.message||"auth.errors.password_reset_failed")}})}backToLogin(){this.router.navigate(["/login"])}static \u0275fac=function(t){return new(t||a)(P(y))};static \u0275cmp=E({type:a,selectors:[["app-password-reset"]],decls:5,vars:3,consts:[[1,"auth-container"],[1,"auth-card"],[1,"verification-content"],[1,"spinner-large"],[1,"verification-text"],[1,"icon-wrapper","success"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2.5"],["stroke-linecap","round","stroke-linejoin","round","d","M5 13l4 4L19 7"],[1,"redirect-info"],[1,"icon-wrapper","error"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18L18 6M6 6l12 12"],[1,"verification-text","error-text"],[1,"submit-btn",3,"click"]],template:function(t,i){t&1&&(e(0,"div",0)(1,"div",1),g(2,D,8,6,"div",2),g(3,N,14,9,"div",2),g(4,V,13,9,"div",2),r()()),t&2&&(n(2),u(i.isProcessing()?2:-1),n(),u(!i.isProcessing()&&i.isSuccess()?3:-1),n(),u(!i.isProcessing()&&i.errorMessage()?4:-1))},dependencies:[O,I,T,R],styles:[".auth-container[_ngcontent-%COMP%]{min-height:calc(100vh - 140px);display:flex;align-items:center;justify-content:center;padding:var(--space-6) var(--space-4);background:var(--bg-secondary)}.auth-card[_ngcontent-%COMP%]{background:var(--bg-primary);border-radius:var(--radius-xl);box-shadow:var(--shadow-lg);padding:var(--space-10) var(--space-8);width:100%;max-width:480px;animation:_ngcontent-%COMP%_slideUp .4s ease-out}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.verification-content[_ngcontent-%COMP%]{text-align:center}.verification-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:clamp(1.25rem,3vw,1.6rem);font-weight:700;color:var(--text-primary);margin:var(--space-5) 0 var(--space-3)}.verification-text[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:var(--text-base, 1rem);line-height:1.6;margin-bottom:var(--space-6)}.error-text[_ngcontent-%COMP%]{color:#dc2626}.icon-wrapper[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;margin:0 auto var(--space-4);display:flex;align-items:center;justify-content:center}.icon-wrapper[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:40px;height:40px}.icon-wrapper.success[_ngcontent-%COMP%]{background:#067a451f;color:#067a45}.icon-wrapper.error[_ngcontent-%COMP%]{background:#dc26261a;color:#dc2626}.spinner-large[_ngcontent-%COMP%]{width:56px;height:56px;border:4px solid var(--border-color);border-top-color:var(--color-primary);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin:0 auto var(--space-5)}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.submit-btn[_ngcontent-%COMP%]{width:100%;padding:var(--space-3) var(--space-6);background:linear-gradient(135deg,#067a45,#048a4f);color:#fff;border:none;border-radius:var(--radius-lg);font-size:var(--text-base, 1rem);font-weight:600;cursor:pointer;transition:all var(--transition-fast, .15s);min-height:48px;margin-top:var(--space-2)}.submit-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 20px #067a4566}"]})};export{L as PasswordReset};
